<h2 class="mb-4">Configurações do Sistema</h2>

<div class="card settings-card mb-4">
    <div class="card-body">
        <h4 class="card-title mb-4">Gerenciamento de Logs</h4>
        <p class="text-danger">Atenção: Esta ação irá apagar permanentemente todos os logs do sistema.</p>
        <button id="resetLogsBtn" class="btn btn-danger">
            <i class="fas fa-trash-alt me-2"></i>Resetar Todos os Logs
        </button>
    </div>
</div>

<div class="card settings-card">
    <div class="card-body">
        <h4 class="card-title mb-4">Gerenciamento de Sessões</h4>
        <p class="text-danger">Esta ação encerra todas as sessões ativas.</p>
        <button id="resetSessionsBtn" class="btn btn-warning">
            <i class="fas fa-power-off me-2"></i>Resetar Sessões
        </button>
    </div>
</div>

<!-- Reset Logs Confirmation Modal -->
<div class="modal fade" id="resetLogsModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirmar Reset de Logs</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Você tem certeza que deseja apagar todos os logs do sistema? Esta ação não pode ser desfeita.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-danger" id="confirmResetLogs">Confirmar Reset</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const resetLogsBtn = document.getElementById('resetLogsBtn');
        const resetLogsModal = new bootstrap.Modal(document.getElementById('resetLogsModal'));
        const confirmResetLogsBtn = document.getElementById('confirmResetLogs');
        const resetSessionsBtn = document.getElementById('resetSessionsBtn');



        resetLogsBtn.addEventListener('click', () => resetLogsModal.show());

        confirmResetLogsBtn.addEventListener('click', async function() {
            try {
                const response = await fetch('/admin/settings/reset-logs', { method: 'POST' });
                if (response.ok) {
                    resetLogsModal.hide();
                    location.reload();
                } else {
                    alert('Erro ao resetar logs.');
                }
            } catch (error) {
                alert('Erro ao resetar logs.');
            }
        });

        resetSessionsBtn.addEventListener('click', async function() {
            if(confirm('Deseja encerrar todas as sessões ativas?')) {
                try {
                    const response = await fetch('/admin/settings/reset-sessions', { method: 'POST' });
                    if (response.ok) {
                        alert('Sessões resetadas');
                    } else {
                        alert('Erro ao resetar sessões');
                    }
                } catch (error) {
                    alert('Erro ao resetar sessões');
                }
            }
        });

    });
</script>
